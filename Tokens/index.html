<!DOCTYPE html>
<html lang="no">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Tokens / Coins</title>

<style>
:root { --gap: 12px; }
* { box-sizing: border-box; }

body {
  margin: 0;
  padding: 24px;
  background: #0f172a;
  color: #e2e8f0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
}

.container {
  max-width: 1000px;
  margin: 0 auto;
  text-align: center;
}

h1 { font-size: 3rem; margin-bottom: 16px; }

.currency-display {
  display: flex;
  justify-content: center;
  gap: 32px;
  margin-bottom: 24px;
  font-size: 1.8rem;
  align-items: center;
}

.currency-display img {
  width: 36px;
  height: 36px;
}

.button {
  padding: 12px 18px;
  border-radius: 14px;
  background: #1f2937;
  color: #f8fafc;
  border: 1px solid #334155;
  cursor: pointer;
  font-weight: 600;
}
.button:disabled { opacity: .5; cursor: not-allowed; }

.scroll-wrapper {
  display: flex;
  justify-content: center;
  width: 100%;
  overflow: visible;
}

.scroll-bar {
  display: flex;
  gap: 12px;
  padding: 24px 0;
  overflow-x: auto;
}

.game-button {
  width: 160px;
  aspect-ratio: 5 / 6;
  border-radius: 16px;
  background: #1f2937;
  border: 1px solid #334155;
  cursor: pointer;
  transition: transform .15s ease;
  position: relative;
  overflow: visible;
}
.game-button:hover {
  transform: translateY(-10px);
}

.game-inner {
  width: 100%;
  height: 100%;
  border-radius: 16px;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.game-image {
  aspect-ratio: 1 / 1;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #020617;
}
.game-image img {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
}

.game-label {
  flex: 1;
  background: rgba(0,0,0,.8);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
}

#modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.7);
  display: none;
  z-index: 900;
}

#game-modal {
  position: fixed;
  inset: 5%;
  background: #0f172a;
  border-radius: 14px;
  display: none;
  z-index: 1000;
}
#game-modal iframe {
  width: 100%;
  height: 100%;
  border: none;
}
</style>
</head>

<body>

<div class="container">
  <h1>What The Facqkuit</h1>

  <div class="currency-display">
    <div><img src="coin.png"><div><span id="coins-count">0</span> Coins</div></div>
    <div><img src="token.png"><div><span id="tokens-count">0</span> Tokens</div></div>
  </div>

  <button class="button" id="convert-button">Bytt Coins til Tokens</button>

  <h2>Spill for 친 tjene Coins:</h2>
  <div class="scroll-wrapper">
    <div class="scroll-bar" id="games-scrollbar"></div>
  </div>
</div>

<div id="modal-overlay"></div>
<div id="game-modal"><iframe id="game-iframe"></iframe></div>

<script>
/* ================== EN FANE /Tokens/ ================== */
(function(){
  // 游뚿 KRITISK: IKKE kj칮r fanel친s i iframe
  if (window.self !== window.top) return;

  const lockKey="activeTokensTab";

  if(localStorage.getItem(lockKey)){
    document.body.innerHTML=`
      <h1 style="text-align:center;margin-top:60px;">
      En annen Token meny er 친pnet!<br>
      Denne fanen er deaktivert.
      </h1>`;
    return;
  }

  const tabId=Date.now()+"-"+Math.random();
  localStorage.setItem(lockKey,tabId);

  window.addEventListener("beforeunload",()=>{
    if(localStorage.getItem(lockKey)===tabId)
      localStorage.removeItem(lockKey);
  });

  setInterval(()=>{
    if(localStorage.getItem(lockKey)!==tabId){
      document.body.innerHTML=`
      <h1 style="text-align:center;margin-top:60px;">
      En annen Token meny er 친pnet!<br>
      Denne fanen er deaktivert.
      </h1>`;
    }
  },500);
})();

/* ================== COINS ================== */
function getCookie(n){
  const m=document.cookie.match(new RegExp('(^| )'+n+'=([^;]+)'));
  return m?parseInt(m[2]):0;
}
function setCookie(n,v){
  document.cookie=`${n}=${v};path=/;max-age=31536000`;
}

let coins=getCookie("coins");
let tokens=getCookie("tokens");

const cEl=document.getElementById("coins-count");
const tEl=document.getElementById("tokens-count");
const btn=document.getElementById("convert-button");

function update(){
  cEl.textContent=coins.toLocaleString();
  tEl.textContent=tokens.toLocaleString();
  btn.disabled=coins<10000;
}
setInterval(()=>{ coins=getCookie("coins"); tokens=getCookie("tokens"); update(); },1000);
update();

btn.onclick=()=>{
  const t=Math.floor(coins/10000);
  coins-=t*10000; tokens+=t;
  setCookie("coins",coins);
  setCookie("tokens",tokens);
};

/* ================== SPILL ================== */
const games=[{name:"Clicker",img:"game1.png",url:"/Tokens/games/Clicker.html"}];

const bar=document.getElementById("games-scrollbar");
const overlay=document.getElementById("modal-overlay");
const modal=document.getElementById("game-modal");
const iframe=document.getElementById("game-iframe");

games.forEach(g=>{
  const b=document.createElement("div");
  b.className="game-button";
  b.innerHTML=`
    <div class="game-inner">
      <div class="game-image"><img src="${g.img}"></div>
      <div class="game-label">${g.name}</div>
    </div>`;
  b.onclick=()=>{
    overlay.style.display="block";
    modal.style.display="block";
    iframe.src=g.url;
  };
  bar.appendChild(b);
});

overlay.onclick=()=>{
  iframe.src="";
  modal.style.display="none";
  overlay.style.display="none";
};
</script>

</body>
</html>
