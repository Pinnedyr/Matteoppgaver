<!DOCTYPE html>
<html lang="no">
<head>
<meta charset="UTF-8">
<title>Terningspill med betting</title>
<style>
/* === GLOBAL BODY === */
body {
    margin: 0;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    height: 100vh;
    display: flex;
    color: #e2e8f0;
    background: #0f172a; /* mørk bakgrunn, firkantede kanter */
}

/* === VENSTRE PANEL === */
.left {
    width: 25%;
    background: #1f2937; /* mørk farge venstre panel */
    padding: 20px;
    box-sizing: border-box;
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    border-radius: 12px;
}

/* Coin display */
.coin-display {
    position: absolute;
    top: 15px;
    right: 15px;
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 18px;
}
.coin-display img { width: 24px; }

/* Terningansikt grid */
.dice-faces {
    margin-top: 60px;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
}

/* Terningnummer ruter */
.face {
    background: #111827;
    border-radius: 12px;
    padding: 20px;
    text-align: center;
    font-size: 24px;
    cursor: pointer;
    border: 1px solid #334155;
    transition: background 0.15s ease, border-color 0.15s ease;
}
.face:hover { background: #374151; border-color: #475569; }
.face.selected { background: #1e40af; border-color: #3b82f6; }

/* Multiplikatorvisning */
.multiplier { margin: 15px 0; }

/* Bet-boks */
.bet-box {
    background: #111827;
    padding: 12px;
    border-radius: 12px;
    margin-bottom: 12px;
    box-sizing: border-box;
    border: 1px solid #334155;
}
.bet-box input {
    width: 100%;
    padding: 12px;
    font-size: 18px;
    border-radius: 12px;
    border: 1px solid #334155;
    outline: none;
    background: #1f2937;
    color: #f8fafc;
    text-align: center;
    box-sizing: border-box;
    transition: background .15s ease, border-color .15s ease;
}
.bet-box input:focus {
    background: #111827;
    border-color: #475569;
}

/* Bet-knapp med mørk bakgrunn og grønn hover-effekt */
button {
    width: 100%;
    padding: 14px;
    font-size: 20px;
    background: #0f172a; /* mørk bakgrunn */
    border: 1px solid #0f172a; /* skjult kantlinje */
    border-radius: 12px;
    cursor: pointer;
    font-weight: bold;
    color: #f8fafc;
    transition: box-shadow 0.3s ease, transform 0.04s ease;
}

button:hover {
    box-shadow: 0 0 10px 2px #22c55e; /* grønn glow */
}

button:active {
    transform: translateY(1px);
}

button:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    box-shadow: none;
}

/* === HØYRE PANEL === */
.right {
    width: 75%;
    background: #0e1524; /* litt mørkere enn venstre panel */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
}

/* === TERNING === */
.dice {
    width: 150px;
    height: 150px;
    background: white; /* original terningfarge */
    border-radius: 12px;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(3, 1fr);
    padding: 15px;
    transition: background 0.4s;
}
.dice.rolling { animation: shake 0.15s infinite; }

@keyframes shake {
    0% { transform: rotate(0deg); }
    25% { transform: rotate(3deg); }
    50% { transform: rotate(0deg); }
    75% { transform: rotate(-3deg); }
    100% { transform: rotate(0deg); }
}

/* Glow-effekter */
.dice.win { animation: glow 0.8s ease-in-out infinite alternate; }
.dice.lose { animation: glow-red 0.8s ease-in-out infinite alternate; }

@keyframes glow {
    from { box-shadow: 0 0 15px gold; }
    to { box-shadow: 0 0 35px gold; }
}
@keyframes glow-red {
    from { box-shadow: 0 0 15px red; }
    to { box-shadow: 0 0 35px red; }
}

/* Terningprikker */
.pip {
    width: 18px;
    height: 18px;
    background: black; /* original black pips */
    border-radius: 50%;
    margin: auto;
    visibility: hidden;
}

/* Coin-burst */
.coin {
    position: absolute;
    width: 24px;
    pointer-events: none;
    animation: burst 1s ease-out forwards;
}

@keyframes burst {
    from { transform: translate(0,0) scale(1); opacity: 1; }
    to { transform: translate(var(--x), -120px) scale(0.5); opacity: 0; }
}

/* Resultat tekst */
.result {
    margin-top: 20px;
    font-size: 20px;
    color: #f8fafc;
}
</style>
</head>

<body>

<script>
(function(){
    const allowedParent = "https://www.wtfq.online/Tokens/";
    let valid = false;
    try { if(window.top !== window.self){ valid = window.parent.location.href.startsWith(allowedParent); } else { valid = document.referrer.startsWith(allowedParent); } }
    catch(e){ valid = false; }
    if(!valid){ document.documentElement.innerHTML=""; setTimeout(()=>{window.location.href=allowedParent;},100); }
})();
</script>

<div class="left">
    <div class="coin-display">
        <img src="https://www.wtfq.online/Tokens/coin.png">
        <span id="coins">0</span>
    </div>

    <div class="dice-faces">
        <div class="face">1</div><div class="face">2</div><div class="face">3</div>
        <div class="face">4</div><div class="face">5</div><div class="face">6</div>
    </div>

    <div class="multiplier">Multiplikator: <span id="multiplier">0x</span></div>

    <div class="bet-box">
        <input type="number" id="betAmount" placeholder="Vedde mengde" step="1">
    </div>

    <button id="betBtn">Vedd</button>
</div>

<div class="right">
    <div class="dice" id="dice">
        <div class="pip"></div><div class="pip"></div><div class="pip"></div>
        <div class="pip"></div><div class="pip"></div><div class="pip"></div>
        <div class="pip"></div><div class="pip"></div><div class="pip"></div>
    </div>
    <div class="result" id="resultText"></div>
</div>

<script>
const faces = document.querySelectorAll('.face');
const dice = document.getElementById('dice');
const pips = dice.children;
const coinsEl = document.getElementById('coins');
const betBtn = document.getElementById('betBtn');
const resultText = document.getElementById('resultText');
const multiplierText = document.getElementById('multiplier');
const betAmount = document.getElementById('betAmount');

// Rettferdige multiplikatorer for 6-sidet terning
const multipliers = {1:6, 2:3, 3:2};

/* COINS */
function getCoins() {
    const c = document.cookie.match(/coins=(\d+)/);
    return c ? +c[1] : 1000;
}
function setCoins(v) {
    document.cookie = "coins=" + v + ";path=/";
    coinsEl.textContent = v;
}
setCoins(getCoins());

/* TERNINGVISNING */
function showDice(n) {
    [...pips].forEach(p => p.style.visibility = "hidden");
    const map = {
        1:[4],2:[0,8],3:[0,4,8],
        4:[0,2,6,8],5:[0,2,4,6,8],6:[0,2,3,5,6,8]
    };
    map[n].forEach(i => pips[i].style.visibility = "visible");
}

/* SLUMPTERMIN */
showDice(Math.floor(Math.random() * 6) + 1);

/* VALG AV TERNINGANSIKT */
faces.forEach(face => face.onclick = () => {
    const sel = document.querySelectorAll('.face.selected');
    if (face.classList.contains('selected')) face.classList.remove('selected');
    else if (sel.length < 3) face.classList.add('selected'); // maks 3 nummer
    if (!document.querySelector('.face.selected')) face.classList.add('selected');

    const c = document.querySelectorAll('.face.selected').length;
    multiplierText.textContent = multipliers[c] ? multipliers[c] + "x" : "0x";

    // Vis dynamiske odds
    const chance = c > 0 ? ((c/6)*100).toFixed(1) : 0;
    resultText.textContent = `Sjanse for å vinne: ${chance}%`;
});

/* COIN-BURST */
function coinBurst() {
    for (let i = 0; i < 12; i++) {
        const c = document.createElement("img");
        c.src = "https://www.wtfq.online/Tokens/coin.png";
        c.className = "coin";
        c.style.left = "50%";
        c.style.top = "45%";
        c.style.setProperty("--x", (Math.random()*200-100)+"px");
        document.querySelector('.right').appendChild(c);
        setTimeout(() => c.remove(), 1000);
    }
}

/* BETTING */
betBtn.onclick = () => {
    const bet = +betAmount.value;
    const picks = [...document.querySelectorAll('.face.selected')].map(f => f.textContent);

    if (!picks.length) return alert("Vennligst velg minst ett terningansikt!");
    if (!bet || bet <= 0) return alert("Vennligst skriv inn et gyldig bet større enn 0!");
    if (bet > getCoins()) return alert("Ikke nok coins!");

    // Trekk bet fra coins
    setCoins(getCoins() - bet);

    betBtn.disabled = true;
    dice.classList.remove("win","lose");
    dice.classList.add("rolling");

    let anim = setInterval(() => showDice(Math.floor(Math.random()*6)+1), 100);

    setTimeout(() => {
        clearInterval(anim);
        dice.classList.remove("rolling");

        const roll = Math.floor(Math.random() * 6) + 1;
        showDice(roll);

        if (picks.includes(String(roll))) {
            dice.classList.add("win");
            const payout = Math.floor(bet * multipliers[picks.length]);
            setCoins(getCoins() + payout); // VINN: legg til payout
            resultText.textContent = `Du rullet ${roll} og vant ${payout} coins!`;
            coinBurst();
        } else {
            dice.classList.add("lose");
            resultText.textContent = `Du rullet ${roll} og tapte ${bet} coins.`;
        }

        betBtn.disabled = false;
    }, 900);
};
</script>
</body>
</html>
